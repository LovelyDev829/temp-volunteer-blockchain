<!DOCTYPE html>
<html>
<head>
    <title>Three.js Particle Test with Trails - Quantum Blockchain</title>
    <link href="style.css" rel="stylesheet" type="text/css"/>
    <style>
        body {
            margin: 0;
            color: #FFFFFF;
            font-family: Arial, sans-serif;
            background-color: #000000;
        }
        .content {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            /* justify-content: center; */
            align-items: center;
            text-align: center;
        }
        h1 {
            font-size: 3em;
            font-weight: 700;
            margin-bottom: 20px;
        }
        p {
            font-size: 1.2em;
            line-height: 1.6;
        }
#WebGL-output {
    position: fixed;
    top: 0;
    left: 0;
    z-index: 1;
}
.content {
    z-index: 2;
    height: 100vh;
}
#article {
  font-size: 16px;
  line-height: 1.5;
}

#read-more {
  color: blue;
  text-decoration: underline;
  cursor: pointer;
}

    </style>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r68/three.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.5/dat.gui.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/r11/Stats.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
    <div id="Stats-output"></div>
    <div id="WebGL-output"></div>
    <div class="content">
        <div id="app">
            <section id='header' ref='header'>
                <div class='wrap'>
                    <div class='ui-grid'>
                        <div class='ui-box'>
                            <h1 class='title' slot='content'><span>Digital Dollar <em>Blockchain</span></em></h1>
                            <div class='ui-fx'>
                                <div class='ui-inner-border l'></div>
                                <div class='ui-inner-border r'></div>
                                <span class='ui-corner' v-for='n in 4' :key='n * Math.random()'></span>
                                <div class='ui-batts' :class='batt' v-for='batt in ["l", "r", "t", "b"]' :key='batt + Math.random()'>
                                    <span class='batt' v-for='n in 2' :key='n * Math.random()'></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        <div id="article">
            
        </div>
    </div>

    <div id="Stats-output"></div>
    <div id="WebGL-output"></div>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.11/vue.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenMax.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TimelineMax.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/easing/EasePack.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/plugins/EaselPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/plugins/TextPlugin.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r121/three.min.js"></script> -->
    <script>
        $(function () {
            var stats = initStats();
            var scene = new THREE.Scene();
            var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
            var webGLRenderer = new THREE.WebGLRenderer();
            
            webGLRenderer.setClearColor(new THREE.Color(0x000000, 1.0));
            webGLRenderer.setSize(window.innerWidth, window.innerHeight);
            webGLRenderer.shadowMapEnabled = true;

            camera.position.x = -30;
            camera.position.y = 40;
            camera.position.z = 50;
            camera.lookAt(new THREE.Vector3(10, 0, 0));

            $("#WebGL-output").append(webGLRenderer.domElement);

            var step = 0;
            var knot;
            var trails = [];  // Array for trails

            var controls = new function () {
                this.radius = 40;
                this.tube = 28.2;
                this.radialSegments = 600;
                this.tubularSegments = 12;
                this.p = 5;
                this.q = 4;
                this.heightScale = 4;
                this.asParticles = true;
                this.rotate = true;
                this.trailLength = 10;  // Added a trail length control

                this.redraw = function () {
                    if (knot) scene.remove(knot);
                    trails.forEach((trail) => scene.remove(trail));
                    trails = [];
                    
                    var geom = new THREE.TorusKnotGeometry(controls.radius, controls.tube, Math.round(controls.radialSegments), Math.round(controls.tubularSegments), Math.round(controls.p), Math.round(controls.q), controls.heightScale);

                    knot = controls.asParticles ? createParticleSystem(geom) : createMesh(geom);
                    scene.add(knot);
                };
            }

            var gui = new dat.GUI();
            gui.add(controls, 'radius', 0, 40).onChange(controls.redraw);
            gui.add(controls, 'tube', 0, 40).onChange(controls.redraw);
            gui.add(controls, 'radialSegments', 0, 400).step(1).onChange(controls.redraw);
            gui.add(controls, 'tubularSegments', 1, 20).step(1).onChange(controls.redraw);
            gui.add(controls, 'p', 1, 10).step(1).onChange(controls.redraw);
            gui.add(controls, 'q', 1, 15).step(1).onChange(controls.redraw);
            gui.add(controls, 'heightScale', 0, 5).onChange(controls.redraw);
            gui.add(controls, 'asParticles').onChange(controls.redraw);
            gui.add(controls, 'rotate').onChange(controls.redraw);
            gui.add(controls, 'trailLength', 1, 50).step(1).onChange(controls.redraw);  // Added GUI control for trail length
            gui.close();

            controls.redraw();
            render();

            function generateSprite() {
                var canvas = document.createElement('canvas');
                canvas.width = 16;
                canvas.height = 16;

                var context = canvas.getContext('2d');
                var gradient = context.createRadialGradient(canvas.width / 2, canvas.height / 2, 0, canvas.width / 2, canvas.height / 2, canvas.width / 2);
                gradient.addColorStop(0, 'rgba(255,255,255,1)');
                gradient.addColorStop(0.2, 'rgba(0,255,255,1)');
                gradient.addColorStop(0.4, 'rgba(0,0,64,1)');
                gradient.addColorStop(1, 'rgba(0,0,0,1)');

                context.fillStyle = gradient;
                context.fillRect(0, 0, canvas.width, canvas.height);

                var texture = new THREE.Texture(canvas);
                texture.needsUpdate = true;
                return texture;
            }

            function createParticleSystem(geom) {
                var material = new THREE.ParticleBasicMaterial({
                    color: 0xffffff,
                    size: 3,
                    transparent: true,
                    blending: THREE.AdditiveBlending,
                    map: generateSprite()
                });

                var system = new THREE.ParticleSystem(geom, material);
                system.sortParticles = true;

                geom.vertices.forEach((particle) => {
                    var trailGeometry = new THREE.Geometry();
                    for (var i = 0; i < controls.trailLength; i++) {
                        trailGeometry.vertices.push(particle.clone());
                    }
                    var trailMaterial = new THREE.LineBasicMaterial({ color: 0xffffff });
                    var trailLine = new THREE.Line(trailGeometry, trailMaterial);
                    trails.push(trailLine);
                    scene.add(trailLine);
                });

                return system;
            }

            function createMesh(geom) {
                var meshMaterial = new THREE.MeshNormalMaterial({});
                meshMaterial.side = THREE.DoubleSide;
                var mesh = THREE.SceneUtils.createMultiMaterialObject(geom, [meshMaterial]);
                return mesh;
            }

            function render() {
                stats.update();

                if (controls.rotate) {
                    knot.rotation.y = step += 0.01;
                }

                trails.forEach((trail, i) => {
                    trail.geometry.vertices.shift();
                    trail.geometry.vertices.push(knot.geometry.vertices[i].clone());
                    trail.geometry.verticesNeedUpdate = true;
                });

                requestAnimationFrame(render);
                webGLRenderer.render(scene, camera);
            }

            function initStats() {
                var stats = new Stats();
                stats.setMode(0); 

                stats.domElement.style.position = 'absolute';
                stats.domElement.style.left = '0px';
                stats.domElement.style.top = '0px';

                $("#Stats-output").append(stats.domElement);

                return stats;
            }
        });
    
        const article = document.getElementById('article');
        const fullContent = "Neveanet's P2P Cloud Infrastructure is an innovative technology that has the potential to revolutionize the internet landscape. The infrastructure enables every device to earn money for using apps and websites. The technology works by sending a piece of the website to store and share with others when a user visits a web property hosted on Neveanet. As the traffic to the website increases, the web hosting bills become cheaper, benefiting the website owners. However, the visitors to the website can also earn a digital dollar for their participation, which is updated every minute, providing real-time earnings.";
        const truncatedContent = fullContent.substring(0, 200) + '...';
        const readMore = '<a href="#" id="read-more">Continue</a>';
        article.innerHTML = truncatedContent + readMore;

        const readMoreBtn = document.getElementById('read-more');
        readMoreBtn.addEventListener('click', function(e) {
            e.preventDefault();
            console.log("first")
            article.innerHTML = fullContent;// + '<a href="#" id="read-less">Read less</a>';
            article.classList.add("pop-up");
            
            // const readLessBtn = document.getElementById('read-less');
            // readLessBtn.addEventListener('click', function(e) {
            //     e.preventDefault();
            //     article.innerHTML = truncatedContent + readMore;
            // });
        });
    </script>
    <!-- <script src="custom.js"></script> -->
</body>
</html>
